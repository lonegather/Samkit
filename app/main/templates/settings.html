{% extends 'site_base.html' %}
{% load samkit %}

{% block title %}
- Settings
{% endblock title %}

{% block content %}
{% if user.is_authenticated %}
<div class="content-settings">
    <section>
        <article>
            <h3>Project Information</h3>
            <form action="/api/project?next={{ current_path }}" method="post" class="w3-container">
                <input name="id" type="hidden" value="{{ current_project.id }}"/>
                <label><b>Name</b></label>
                <input name="info" type="text" value="{{ current_project.info }}" class="w3-input" style="margin-bottom:20px;background-color:#f1f1f1"/>
                <label><b>Codename</b></label>
                <input name="name" type="text" value="{{ current_project.name }}" class="w3-input" style="margin-bottom:20px;background-color:#f1f1f1"/>
                <label><b>Root Directory</b></label>
                <input name="root" type="text" value="{{ current_project.root }}" class="w3-input" style="margin-bottom:20px;background-color:#f1f1f1"/>
                <button type="submit" class="w3-btn w3-purple" style="width:80px;margin-bottom:10px;">APPLY</button>
            </form>
            <h3>Stage Configuration</h3>
            <div class="row">
                <div class="w3-container list" id="stage_list">
                    {% for stage in stages %}
                    <button style="display:block;width:100%;text-align:left" class="w3-btn" onclick="open_stage_detail('{{ stage.id }}','{{ stage.name }}','{{ stage.info }}')">
                        [{{ stage.name }}] {{ stage.info }}
                    </button>
                    {% empty %}
                    <p>No stage found. Click ADD to create a new one.</p>
                    {% endfor %}
                    <button type="button" class="w3-btn" style="display:block;width:100%;text-align:left">ADD...</button>
                </div>
                <div class="detail" id="stage_detail">
                    <button onclick="close_stage_detail()">close</button>
                </div>
            </div>
            <h3>Asset Category</h3>
            <div class="row">
                <div class="w3-container list" id="tag_list">
                    {% for tag in tags %}
                        {% if tag.genus.name == 'asset' %}
                        <button style="display:block;width:100%;text-align:left" class="w3-btn" onclick="open_tag_detail('{{ tag.id }}','{{ tag.name }}','{{ tag.info }}')">
                            [{{ tag.name }}] {{ tag.info }}
                        </button>
                        {% endif %}
                    {% empty %}
                    <p>No asset category found. Click ADD to create a new one.</p>
                    {% endfor %}
                    <button type="button" class="w3-btn" style="display:block;width:100%;text-align:left">ADD...</button>
                </div>
                <div class="detail" id="tag_detail">
                    <button onclick="close_tag_detail()">close</button>
                </div>
            </div>
            <h3>Episode Configuration</h3>
            <div class="row">
                <div class="w3-container list" id="ep_list">
                    {% for tag in tags %}
                        {% if tag.genus.name == 'shot' %}
                        <button style="display:block;width:100%;text-align:left" class="w3-btn" onclick="open_ep_detail('{{ tag.id }}','{{ tag.name }}','{{ tag.info }}')">
                            [{{ tag.name }}] {{ tag.info }}
                        </button>
                        {% endif %}
                    {% empty %}
                    <p>No episode found. Click ADD to create a new one.</p>
                    {% endfor %}
                    <button type="button" class="w3-btn" style="display:block;width:100%;text-align:left">ADD...</button>
                </div>
                <div class="detail" id="ep_detail">
                    <button onclick="close_ep_detail()">close</button>
                </div>
            </div>
        </article>
    </section>
</div>
{% else %}
<h3>You must sign in to access this page.</h3>
{% endif %}
{% endblock content %}

{% block script %}
function open_tag_detail(tag_id, tag_name, tag_info) {
    document.getElementById('tag_detail').style.display = 'block';
}

function close_tag_detail() {
    document.getElementById('tag_detail').style.display = 'none';
}
function open_ep_detail(tag_id, tag_name, tag_info) {
    document.getElementById('ep_detail').style.display = 'block';
}

function close_ep_detail() {
    document.getElementById('ep_detail').style.display = 'none';
}
function open_stage_detail(stage_id, stage_name, stage_info) {
document.getElementById('stage_detail').style.display = 'block';
}

function close_stage_detail() {
document.getElementById('stage_detail').style.display = 'none';
}
{% endblock script %}